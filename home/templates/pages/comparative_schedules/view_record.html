{% extends 'layouts/base.html' %}
{% load static %}

{% block title %} Dashboard {% endblock title %}
{% block content %}

<!-- [ Main Content ] start -->
<div class="pc-container">
    <div class="pc-content">
      <!-- [ Main Content ] start -->
      <div class="row">
        <!-- [ sample-page ] start -->
       
        <form class="row g-3">
            <div id="overlay">
                <img src="{% static 'assets/images/dribbble-progress-bar.gif' %}" alt="Loading" />
                
           </div>
            <!-- <div class="col-md-6">
                <a href="show_pdf/record.upload">upload {{record.upload}} </a>

                <input type="text" class="form-control" id="request_id" name="request_id" value="" readonly> -->
            <!-- </div>  -->
            <div class="col-md-6">
                <label  class="form-label">From Purchase Request:</label>
                <input type="text" class="form-control" id="purchase_request" name="purchase_request" value="" readonly>
            </div>


 

            <hr>

            <legend>Supplier 1</legend>
            
            <div class="col-md-6">
                <label  class="form-label">Supplier 1 (Company Name):</label>
                <input type="text" class="form-control" id="company_name_supplier1" name="company_name_supplier1" value="" readonly>
            </div>

            <div class="col-md-6">
                <label  class="form-label">Item Name. (Supplier 1):</label>
                <input type="text" class="form-control" id="item_name_supplier1" name="item_name_supplier1" value="" readonly>
            </div>

            <div class="col-md-12">
                <label  class="form-label"> Description:</label>
                <textarea type="text" class="form-control" id="desc_supplier1" name="desc_supplier1" value="" readonly></textarea>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Qty:</label>
                <input type="text" class="form-control" id="qnty_supplier1" name="qnty_supplier1" value="" readonly>
            </div>
            
            <div class="col-md-4">
                <label  class="form-label">Unit Price:</label>
                <input type="text" class="form-control" id="unit_price_supplier1" name="unit_price_supplier1" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Total Price:</label>
                <input type="text" class="form-control" id="total_price_supplier1" name="total_price_supplier1" value="" readonly>
            </div>

            <!-- <div class="col-md-4">
                <label  class="form-label">File for supplier1:</label>
                <input type="file" class="form-control" id="upload" value="" name="upload" accept=".doc, .docx, .pdf, .txt">
            </div> -->

            <!-- <div class="col-md-4">                
                <label  class="form-label">File2 for supplier1:</label>
                {{record.upload_name}}

            </div> -->

            <legend>Supplier 2</legend>
            <div class="col-md-6">
                <label  class="form-label">Supplier 2 (Company Name):</label>
                <input type="text" class="form-control" id="company_name_supplier2" name="company_name_supplier2" value="" readonly>
            </div>

            <div class="col-md-6">
                <label  class="form-label">Item Name. (supplier 2):</label>
                <input type="text" class="form-control" id="item_name_supplier2" name="item_name_supplier2" value="" readonly>
            </div>

            <div class="col-md-12">
                <label  class="form-label">Description:</label>
                <textarea type="text" class="form-control" id="desc_supplier2" name="desc_supplier2" value="" readonly></textarea>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Qty:</label>
                <input type="text" class="form-control" id="qnty_supplier2" name="qnty_supplier2" value="" readonly>
            </div>
            
            <div class="col-md-4">
                <label  class="form-label">Unit price:</label>
                <input type="text" class="form-control" id="unit_price_supplier2" name="unit_price_supplier2" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Total Price:</label>
                <input type="text" class="form-control" id="total_price_supplier2" name="total_price_supplier2" value="" readonly>
            </div>

            <hr>
            
            <legend>Supplier 3</legend>
            <div class="col-md-6">
                <label  class="form-label">Supplier 3 (Company Name):</label>
                <input type="text" class="form-control" id="company_name_supplier3" name="company_name_supplier3" value="" readonly>
            </div>

            <div class="col-md-6">
                <label  class="form-label">Item Name:</label>
                <input type="text" class="form-control" id="item_name_supplier3" name="item_name_supplier3" value="" readonly>
            </div>

            <div class="col-md-12">
                <label  class="form-label">Description:</label>
                <textarea type="text" class="form-control" id="desc_supplier3" name="desc_supplier3" value="" readonly></textarea>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Qty:</label>
                <input type="text" class="form-control" id="qnty_supplier3" name="qnty_supplier3" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Unit Price:</label>
                <input type="text" class="form-control" id="unit_price_supplier3" name="unit_price_supplier3" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Total Price:</label>
                <input type="text" class="form-control" id="total_price_supplier3" name="total_price_supplier3" value="" readonly>
            </div>
            
            <hr>

            <div class="col-md-4">
                <label  class="form-label">Recommended Supplier:</label>
                <input type="text" class="form-control" id="recommended_supplier" name="recommended_supplier" value="" readonly>
            </div>

            <div class="col-md-8">
                <label  class="form-label">Reasons for recommendations:</label>
                <textarea type="text" class="form-control" id="recommended_supplier_reason" name="recommended_supplier_reason" value="" readonly></textarea>
            </div>



            <hr>

            <div class="col-md-4">
                <label  class="form-label">Requested By:</label>
                <input type="text" class="form-control" id="requested_by" name="requested_by" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Signature:</label>
                <input type="text" class="form-control" id="requested_by_sig" name="requested_by_sig" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Date:</label>
                <input type="text" class="form-control" id="requested_by_date" name="requested_by_date" value="" readonly>
            </div>
            
            <hr>

            <div class="col-md-4">
                <label  class="form-label">Technical Person:</label>
                <input type="text" class="form-control" id="tech_person_by" name="tech_person_by" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Signature:</label>
                <input type="text" class="form-control" id="tech_person_by_sig" name="tech_person_by_sig" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Date:</label>
                <input type="text" class="form-control" id="tech_person_date" name="tech_person_date" value="" readonly>
            </div>
            <hr>

            <div class="col-md-4">
                <label  class="form-label">Dept Head:</label>
                <input type="text" class="form-control" id="dpt_head_by" name="dpt_head_by" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Signature:</label>
                <input type="text" class="form-control" id="dpt_head_by_sig" name="dpt_head_by_sig" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Date:</label>
                <input type="text" class="form-control" id="dpt_head_date" name="dpt_head_date" value="" readonly>
            </div>

            <hr>




<!-- <hr>

            <div class="col-md-6">
                <label  class="form-label">Select DG/PI</label>
                <select class="form-control" name="approved_by" id="approved_by">
                    <option value="None">..</option>
    
                    </select>  
            </div> -->
            <hr>





            <hr>

            <div class="col-md-4">
                <label  class="form-label">Approved by Chairperson:</label>
                <input type="text" class="form-control" id="approved_by" name="approved_by" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Signature:</label>
                <input type="text" class="form-control" id="approved_by_sig" name="approved_by_sig" value="" readonly>
            </div>

            <div class="col-md-4">
                <label  class="form-label">Date:</label>
                <input type="text" class="form-control" id="approved_date" name="approved_date" value="" readonly>
            </div>
            <hr>

            <div class="col-md-4">
                <label for="certifier" class="form-label">Quotation1</label>
                <a id="quotation1" class="btn btn-primary" href="8010125.pdf" target="_blank">View</a>
            </div>  
            <div class="col-md-4">
                <label for="certifier" class="form-label">Quotation2</label>
                <a id="quotation2" class="btn btn-primary" href="8010125.pdf" target="_blank">View</a>
            </div>     
            
            <div class="col-md-4">
                <label for="certifier" class="form-label">Quotation3</label>
                <a id="quotation3" class="btn btn-primary" href="8010125.pdf" target="_blank">View</a>
            </div>


          </form> 
          {% if record.rejector == "None" %}
          {% else %}
        <div style="position: fixed; 
          bottom: 500px; 
          left: 200px;
          z-index: 10000;
          font-size:100px; 
          color: red; 
          transform:rotate(-30deg);
          opacity: 0.6;">
            rejected by {{record.rejector}}
            </div>

            <p>Rejection message :<b>{{record.rejector_message}}</b> </p>
            <p>Rejection date :<b>{{record.rejector_date}}</b> </p>

        {% endif %}


          <div class="col-md-12" style="margin-top: 3%;">
            <a onclick="print();" id="approve" class="btn btn-primary"> Print</a>

            <script  language="JavaScript" type="text/javascript">







                // populating the already existing records
                
                            current_url = window.location.href;
                                        arr = current_url.split("/");
                                        case_id = arr.at(-1);
                                        console.log("ghere ");

                                    console.log(case_id);
                                    if (case_id == "add"){}else{
                                    const url = "  http://kaslor.co.zw/procurement/comp_schedule_get_record"
                                    const data = {
                                      'id':case_id,
                                    }
                    
                                      $.post(url,data, function(data,status){
                            
                            if (data['message']=="success"){
                
                    // $("#request_id").val(data['request_id']);
                    $("#purchase_request").val(data['purchase_request']);

                    $('#quotation1').attr('href',data['pdf1']);
                    $('#quotation2').attr('href',data['pdf2']);
                    $('#quotation3').attr('href',data['pdf3']);

                    console.log(data['pdf1']);
                    console.log(data['pdf2']);
                    console.log(data['pdf3']);


                    $("#upload").val(data['upload_name']);
                    $("#company_name_supplier1").val(data['company_name_supplier1']);
                    $("#item_name_supplier1").val(data['item_name_supplier1']);
                    $("#desc_supplier1").val(data['desc_supplier1']);
                    $("#qnty_supplier1").val(data['qnty_supplier1']); 
                    $("#unit_price_supplier1 ").val(data['unit_price_supplier1']);
                    $("#total_price_supplier1").val(data['total_price_supplier1']);

                    $("#company_name_supplier2").val(data['company_name_supplier2']);
                    $("#item_name_supplier2").val(data['item_name_supplier2']);
                    $("#desc_supplier2").val(data['desc_supplier2']);
                    $("#qnty_supplier2").val(data['qnty_supplier2']); 
                    $("#unit_price_supplier2 ").val(data['unit_price_supplier2']);
                    $("#total_price_supplier2").val(data['total_price_supplier2']);

                    $("#company_name_supplier3").val(data['company_name_supplier3']);
                    $("#item_name_supplier3").val(data['item_name_supplier3']);
                    $("#desc_supplier3").val(data['desc_supplier3']);
                    $("#qnty_supplier3").val(data['qnty_supplier3']); 
                    $("#unit_price_supplier3 ").val(data['unit_price_supplier3']);
                    $("#total_price_supplier3").val(data['total_price_supplier3']);

                    $("#recommended_supplier").val(data['recommended_supplier']);
                    $("#recommended_supplier_reason").val(data['recommended_supplier_reason']);

                    $("#requested_by").val(data['requested_by']); 
                    $("#requested_by_sig ").val(data['requested_by_sig']);
                    $("#requested_by_date").val(data['requested_by_date']);

                    $("#tech_person_by").val(data['tech_person_by']); 
                    $("#tech_person_by_sig ").val(data['tech_person_by_sig']);
                    $("#tech_person_date").val(data['tech_person_date']);

                    $("#dpt_head_by").val(data['dpt_head_by']); 
                    $("#dpt_head_by_sig ").val(data['dpt_head_by_sig']);
                    $("#dpt_head_date").val(data['dpt_head_date']);


                    $("#approved_by").val(data['approved_by']); 
                    $("#approved_by_sig ").val(data['approved_by_sig']);
                    $("#approved_date").val(data['approved_date']); 
                    
                    
                    // populate the users dropdown

const url = "  http://kaslor.co.zw/procurement/get_users"
                    const data1 = {
                      'id':"case_id",
                    }
            
                      $.post(url,data1, function(data1,status){
            

                        console.log(data1)


                        $.each(data1, function(val, text) {
                            $('#dpt_head_by').append( new Option(text,val) );
                        });

            
  
    
                        $('#overlay').fadeOut();


        });
                        }
                        else{
                            alert(data['message']);
                            $('#overlay').fadeOut();
                            console.log(data);
                            return;
                            // window.location.href="/comp_schedule_all";
                        }
                        });
                    }
                


                    function print(){

current_url = window.location.href;
                    arr = current_url.split("/");
                    case_id = arr.at(-1);

window.location.href="  http://kaslor.co.zw/procurement/comp_schedule_print/"+case_id;
                    }
                  
                    

                        </script>
{% endblock content %}