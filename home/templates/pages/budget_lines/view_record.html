{% extends 'layouts/base.html' %}
{% load static %}

{% block title %} Dashboard {% endblock title %}
{% block content %}
<!-- [ Main Content ] start -->
<div class="pc-container">
    <div class="pc-content">
      <!-- [ Main Content ] start -->
      <div class="row">
        <!-- [ sample-page ] start -->
       
        <form class="row g-3">

            <div id="overlay">
                <img src="{% static 'assets/images/dribbble-progress-bar.gif' %}" alt="Loading" />
                
           </div>
<!-- 
            <div class="col-md-12">
                <label for="fname" class="form-label">Add From Comparative Schedule:</label>
                <select class="form-control" name="comp_schedule" id="comp_schedule">
                    <option value="None">..</option>
    
                    </select>           
             </div> -->

            <!-- <div class="col-md-6">
                <label for="fname" class="form-label">Requestor:</label>
                <input type="text" class="form-control" id="requester" name="requester" value="" required/>
            </div>

            <div class="col-md-6">
                <label for="fname" class="form-label">Date:</label>
                <input type="text" class="form-control" id="date_of_request" name="date_of_request" value="" required/>
            </div>
            <p></p> -->

            



             <div class="col-md-6">
                <label for="name" class="form-label"> Line Name:</label>
                <input type="text" class="form-control" id="name" name="name" value="" required/>
            </div>

            <div class="col-md-12">
                <label for="fname" class="form-label">Department:</label>
                <select class="form-control" name="dpt" id="dpt">
                    <option value="None">..</option>
    
                    </select>           
             </div>

            <div class="col-md-12">
                <label for="fname" class="form-label">Project:</label>
                <select class="form-control" name="project" id="project">
                    <option value="None">..</option>
    
                    </select>           
             </div>


            <div class="col-md-6">
                <label for="lname" class="form-label">Line Code:</label>
                <input type="text" class="form-control" id="code" name="code" value="" required/>
            </div>

            <div class="col-md-12">
                <label for="fname" class="form-label">Line Total:</label>
                <input type="number" class="form-control" id="amount" name="amount" value="" required/>
            </div>
            
          </form>


            <script  language="JavaScript" type="text/javascript">



                // populating the already existing records
                
                current_url = window.location.href;
                                        arr = current_url.split("/");
                                        case_id = arr.at(-1);
                                    console.log(case_id);
                                    $("#request_id").val(case_id);
                                    if (case_id == "add"){}else{
                                    const url = "  https://kaslor.co.zw/procurement/budget_lines_get_record"
                                    const data = {
                                      'id':case_id,
                                    }
                            
                                      $.post(url,data, function(data,status){
                            
                if (data['message']=="success"){

                
                    $("#dpt").val(data['dpt']);

                    $("#name").val(data['name']);

                    $("#project").val(data['project']);
                    $("#amount").val(data['amount']);

                    $("#code").val(data['code']);
                    $("#balance").val(data['balance']);

                    $("#added_by").val(data['added_by']);

                    $("#added_by_date").val(data['added_by_date']);
                    $("#last_used").val(data['last_used']);
                    

                   $('#overlay').fadeOut();
     
                }else{
                    $('#overlay').fadeOut();

                            alert(data['message']);
                            window.location.href="/procurement/budget_lines_all";
                
                        }
                
            });
    }








</script>
                
                
                
                


{% endblock content %}