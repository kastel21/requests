{% extends 'layouts/base.html' %}
{% load static %}

{% block title %} Dashboard {% endblock title %}
{% block content %}
<!-- [ Main Content ] start -->
<div class="pc-container">
    <div class="pc-content">
      <!-- [ Main Content ] start -->
      <div class="row">
        <!-- [ sample-page ] start -->
       
        <form class="row g-3">

            <div id="overlay">
                <img src="{% static 'assets/images/dribbble-progress-bar.gif' %}" alt="Loading" />
                
           </div>

            <!-- <div class="col-md-6">
                <label for="fname" class="form-label">Add Comparative Schedule:</label>
                <select class="form-control" name="comp_schedule" id="comp_schedule">
                    <option value="None">..</option>
    
                    </select>            
                </div> -->



                    <!-- <div class="col-md-6">
                        <label for="fname" class="form-label">Add Procurement Request:</label>
                        <select class="form-control" name="service_request" id="service_request">
                            <option value="None">..</option>
            
                            </select>            
                        </div> -->
            <!-- <div class="col-md-6">
                <label for="fname" class="form-label">Requestor:</label>
                <input type="text" class="form-control" id="requester" name="requester" value="">
            </div>

            <div class="col-md-6">
                <label for="fname" class="form-label">Date:</label>
                <input type="text" class="form-control" id="date_of_request" name="date_of_request" value="">
            </div>
            <p></p> -->

            <div class="col-md-6">
                <label for="fname" class="form-label">Requesting Department:</label>
                <input type="text" class="form-control" id="requesting_dpt" name="requesting_dpt" value="">
            </div>

            <div class="col-md-6">
                <label for="fname" class="form-label">Budget Line Item (Where applicable):</label>
                <input type="text" class="form-control" id="budget_line_item" name="budget_line_item" value="">
            </div>

            <div class="col-md-6">
                <label for="lname" class="form-label">Request Justification:</label>
                <input type="text" class="form-control" id="request_justification" name="request_justification" value="">
            </div>
<!-- 
            <div class="col-md-6">
                <label for="fname" class="form-label">Name and address of Supplier:</label>
                <input type="text" class="form-control" id="name_address_of_supplier" name="name_address_of_supplier" value="">
            </div> -->


            <div class="col-md-6">
                <label for="lname" class="form-label">Name of Item</label>
                <input type="text" class="form-control" id="item_name" name="item_name" value="">
            </div>


            <div class="col-md-6">
                <label for="fname" class="form-label">QTY:</label>
                <input type="number" class="form-control" id="qnty" name="qnty" value="">
            </div>



            <div class="col-md-12">
                <label for="fname" class="form-label">Description of item:</label>
                <textarea type="text" class="form-control" id="description" name="description" value=""></textarea>
            </div>

            <p></p>



            <p></p>
<!-- 
            <div class="col-md-4">
                <label for="q1" class="form-label">Quotaion 1:</label>

                <input type="file" accept="application/pdf, application/vnd.ms-excel" class="form-control" id="q1" name="q1" value="John">
            </div> -->

            <!-- <div class="col-md-4">
                <label for="q2" class="form-label">Quotaion 2:</label>
                <input type="file" accept="application/pdf, application/vnd.ms-excel" class="form-control" id="q2" name="q2" value="John">
            </div>

            <div class="col-md-4">
                <label for="q3" class="form-label">Quotaion 3:</label>
                <input type="file" accept="application/pdf, application/vnd.ms-excel" class="form-control" id="q3" name="q3" value="John">
            </div> -->




<!-- 
            <div class="col-md-6">
                <label for="fname" class="form-label">Date:</label>
                <input type="text" class="form-control" id="date_of_request" name="date_of_request" value="">
            </div> -->


            <div class="col-md-12">
                <label for="certifier" class="form-label">Department Head/Designee</label>
                <select class="form-control" name="pi" id="pi">
                <option value="None">..</option>

                </select>
            </div>

            <!-- <div class="col-md-6">
                <label for="fname" class="form-label"> PI/Supervisor:</label>
                <input type="text" class="form-control" id="supervisor_approved" name="supervisor_approved" value="">
            </div>

            <div class="col-md-6">
                <label for="lname" class="form-label">Date:</label>
                <input type="text" class="form-control" id="supervisor_approved_date" name="supervisor_approved_date" value="">
            </div>

            <div class="col-md-6">
                <label for="fname" class="form-label"> Accounts Clerk</label>
                <input type="text" class="form-control" id="accounts_clerk_approved" name="accounts_clerk_approved" value="">
            </div>

            <div class="col-md-6">
                <label for="fname" class="form-label">Date</label>
                <input type="text" class="form-control" id="accounts_clerk_approved_date" name="accounts_clerk_approved_date" value="">
            </div> -->

          </form>

          <div class="col-md-12">
            <a onclick="sendEdit();" class="btn btn-primary"> SUBMIT</a>

            <script  language="JavaScript" type="text/javascript">




// $('#comp_schedule').on('change', function(event) {
//        alert("This is the value selected in solutions: " + $(this).val());


//   });










const url1 = "  https://lorkas.co.zw/get_users"
                    const data1 = {
                      'id':"case_id",
                    }
            
                      $.post(url1,data1, function(data1,status){
            

console.log(data1)


                        $.each(data1, function(val, text) {
                            $('#pi').append( new Option(text,val) );
                        });

            
  
    
                        $('#overlay').fadeOut();


        });




function sendEdit(){
                        window.scrollTo({ top: 0, behavior: 'smooth' });

                        $('#overlay').fadeIn();



    var requesting_dpt= $("#requesting_dpt").val();
        var budget_line_item= $("#budget_line_item").val();
        var request_justification= $("#request_justification").val();

        var item_name= $("#item_name").val();
        var description= $("#description").val();



        var qnty = $("#qnty").val();



        var supervisor_approved= $("#pi").val();

                                    current_url = window.location.href;
                                    arr = current_url.split("_");
                                    case_id = arr.at(-1);
                                if (case_id == "add"){
                        
                                const url = "  https://lorkas.co.zw/purchase_request_send_record";
                                // current_url = window.location.href;
                                // arr = current_url.split("/");
                                // case_id = arr.at(-1);
                                // month_id =arr[arr.length - 2];
                                console.log("after url");
                                const data = {
                                                    // "q1": q1,
                                                    "requesting_dpt": requesting_dpt,
                                                    "budget_line_item": budget_line_item,
                                                    "item_name":item_name,
                                                    "description":description,
                        
                                                    "request_justification": request_justification,

                                                    "qnty": qnty,
                                                    "id": case_id,
                        
                                                    "supervisor_approved": supervisor_approved,
                                                    // "supervisor_approved_date": supervisor_approved_date,
                        
                                                    // "accounts_clerk_approved": accounts_clerk_approved,
                                                    // "accounts_clerk_approved_date": accounts_clerk_approved_date,
                        
                                                }
                        
                                        console.log("after dict");
                                $.post(url,data, function(data,status){
                                if (data['message']=="success"){
                                    alert("success");
                                    $('#overlay').fadeOut();
                                    window.location.href="  https://lorkas.co.zw/purchase_request_all";

                                    //window.location.href="  https://lorkas.co.zw/purchase_request_quote_upload/"+data['id'];
                                }else{
                                    alert(data['message']);
                                    console,log("err")
                                    $('#overlay').fadeOut();
                                    return;
                                    // window.location.href="  https://lorkas.co.zw/purchase_requests_all";
                        
                                }
                        
                                });
                                // alert("stop hee");
                            }
                        
                    }
                        </script>
                
                
                
                


{% endblock content %}